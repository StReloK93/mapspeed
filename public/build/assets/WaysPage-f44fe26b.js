import{bF as D,d as h,e as i,g,o as _,c as y,f as w,r as m,b as u,w as C,a as s}from"./app-e9234c57.js";import{h as f,W as k}from"./Wialon-d02f08bb.js";import{H as L}from"./highcharts-ba9c9956.js";import{L as W,_ as z}from"./PreLoader.vue_vue_type_script_setup_true_lang-052099b1.js";import{a as Y}from"./TimezoneDate-73bb07cd.js";import"./_commonjsHelpers-de833af9.js";async function M(d){const{data:n}=await D.post("api/get_way_speed",d);return n}const S={getWaysSpeed:M},T=h({__name:"ChartLine",setup(d,{expose:n}){function r(o){const e=new Date(o);return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes())}function t(o){a.value.series[0].setData(o.map(e=>({y:e.average_speed,x:r(e.hour)})))}const l=i(),a=i(null),p={accessibility:{enabled:!1},chart:{backgroundColor:"transparent",type:"spline",scrollablePlotArea:{}},title:null,subtitle:null,xAxis:{gridLineColor:"transparent",gridLineWidth:0,lineWidth:0,minorGridLineWidth:10,type:"datetime",labels:{overflow:"justify"}},yAxis:{min:0,max:50,title:null,minorGridLineWidth:0,gridLineWidth:0,alternateGridColor:null},tooltip:{valueSuffix:" Km/s"},plotOptions:{spline:{lineWidth:4,states:{hover:{lineWidth:5}},marker:{enabled:!1},pointInterval:36e5,pointStart:Date.UTC(2020,3,15,0,0,0)}},series:[{name:"Tezlik smena bo'yicha",data:[]}],navigation:{menuItemStyle:{fontSize:"10px"}}};return n({getChartData:t}),g(()=>{a.value=L.chart(l.value,p)}),(o,e)=>(_(),y("main",{class:"h-64 w-full",ref_key:"chartLine",ref:l},null,512))}}),V={class:"fixed inset-0"},P=s("i",{class:"fa-duotone fa-house"},null,-1),R={class:"absolute top-0 right-0 p-2 z-50 flex w-96 flex-col bg-blue-200/50 rounded-b-2xl"},I=h({__name:"WaysPage",setup(d){const n=i(),r=Y(f()),t=w({currentDate:r.date,wialon:null,geozones:null,leaflet:null,loading:!1,smena:r.smena}),l=i(),a=i({start:null,end:null});function p(){var e;l.value.getChartData([]),(e=t.leaflet)==null||e.rectanglesClear()}async function o(){const e=t.leaflet.getRectanglePoints(),c=await S.getWaysSpeed({startDay:f(a.value.start).format("YYYY-MM-DD"),endDay:f(a.value.end).format("YYYY-MM-DD"),points:e});l.value.getChartData(c)}return g(async()=>{t.leaflet=new W(n.value,!0),t.wialon=new k(t.leaflet.map)}),(e,c)=>{const x=m("RouterLink"),b=m("VDatePicker");return _(),y("section",V,[u(z,{loading:t.loading},null,8,["loading"]),u(x,{to:"/",class:"absolute left-3 top-3 btn-line bg-white shadow-md !text-xl z-50 text-center content-center"},{default:C(()=>[P]),_:1}),s("div",R,[s("button",{onClick:p,class:"bg-white px-4 py-1.5 rounded-full mb-2"},"Tozalash"),u(T,{ref_key:"chartLineRef",ref:l},null,512),u(b,{modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=v=>a.value=v),mode:"date",class:"my-2","is-range":"",expanded:""},null,8,["modelValue"]),s("button",{onClick:o,class:"px-4 py-1.5 rounded-full bg-blue-500 text-white"},"Tasdiqlash")]),s("div",{ref_key:"geozonemap",ref:n,class:"h-full w-full z-40"},null,512)])}}});export{I as default};
